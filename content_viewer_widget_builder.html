<!--
Jive - Content Viewer Widget

Copyright (c) 2015-2016 Fidelity Investments
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

FILE DESCRIPTION
This is the builder application that presents a front end to users and allows
them to configure a Content Viewer widget with a setup document.  The user needs 
to complete the configuration and generate the widget code.  This code is then 
pasted into HTML Widgets on an Overview page to create the content viewer.

WIDGET DESCRIPTION
This Jive HTML widget loads in a Jive setup document with a bullet list representing
the Table of Contents.
-->
<meta name="fidosreg" content="b764a0a9536448345dc227af95e192521d337b5e4c3560c859b89ecd0407004a">

<script src='JQUERY'></script>
<script>

var jquery_content_id = "0";
var library_loader_content_id = "0";

var $j = jQuery.noConflict();
$j("head").append('<scr'+'ipt src="/api/core/v3/attachments/file/' + library_loader_content_id + '/data"></scr'+'ipt>');
</script>
<script>
$j.load_library('bootstrap.css');
$j.load_library('bootstrap-theme.css');
$j.load_library('spectrum.css');
$j.load_library('content_viewer_widget_builder.css');
$j.load_library('bootstrap.js');
$j.load_library('spectrum.js');
//$j.load_library('content_viewer_widget_builder.js');
</script>
<script>
/*
Jive - Accordion Widget

Copyright (c) 2015 Fidelity Investments
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

FILE DESCRIPTION
This is the Javascript library that drives the Accordion Widget Builder app.

WIDGET DESCRIPTION
This Jive HTML widget loads in a Jive setup document with a two column table.
The table content is parsed into a Bootstrap accordion.  This allows users to 
expand and contract the panels to show and hide the contained information.
*/
var fidosreg_id = 'b764a0a9536448345dc227af95e192521d337b5e4c3560c859b89ecd0407004a';
var sourceURL = '';
var URLCheck = '/docs/';
var showTOCIcons = false;
var showTOCHovers = false;
var toc_layout = 'vertical';
var unselectedTextColor = '#069';
var unselectedBackgroundColor = '#ffffff';
var unselectedBorderColor = '#BDBDBD';
var hoverTextColor = '#069';
var hoverBackgroundColor = '#ffffff';
var hoverBorderColor = '#BDBDBD';
var selectedTextColor = '#069';
var selectedBackgroundColor = '#f0f0f0';
var selectedBorderColor = '#BDBDBD';
var fontSize = 12;
var borderWidth = 1;

function hideAll() {
	$j('#tocDiv').hide();
	$j('#customizationPage').hide();
	$j('#generatedCodeDiv').hide();
}

function toggleNextButton() {
	if($j('#docURLInput').val().length > 0 && $j('#docURLInput').val().indexOf(URLCheck) >= 0) {
		$j('#nextButton').attr('disabled', false);
		$j('#URLStatus').html('');
	} else {
		$j('#nextButton').attr('disabled', true);
	}
}

function customize(){
	hideAll();
	customizeMenu();
	$j('#customizationPage').show();
	resize();
}

function customizeMenu() {
	$j('#selected-item').css({
		'color': selectedTextColor,
		'background-color': selectedBackgroundColor,
		'border': borderWidth + 'px solid ' + selectedBorderColor,
		'font-size': fontSize + 'px'
	});
	$j('#hover-item').css({
		'color': hoverTextColor,
		'background-color': hoverBackgroundColor,
		'border': borderWidth + 'px solid ' + hoverBorderColor,
		'font-size': fontSize + 'px'
	});
	$j('#unselected-item').css({
		'color': unselectedTextColor,
		'background-color': unselectedBackgroundColor,
		'border-color': unselectedBorderColor,
		'border': borderWidth + 'px solid ' + unselectedBorderColor,
		'font-size': fontSize + 'px'
	});
}

function finish(){
	hideAll();
	sourceURL = $j('#docURLInput').val();
	toc_layout = $j('#toc_layout input:radio:checked').val();
	if ( document.getElementById('tocIcons').checked ) {
		showTOCIcons = true;
	} else {
		showTOCIcons = false;
	}
	if ( document.getElementById('tocHover').checked ) {
		showTOCHovers = true;
	} else {
		showTOCHovers = false;
	}

	$j('#tocCodeBox').text("<div class='toc-menu-container'></div>");

	$j('#viewerCodeBox').text(	"<scr"+"ipt src='/api/core/v3/attachments/file/" + jquery_content_id + "/data'></scr"+"ipt>\n" 
								+ "<scr"+"ipt src='/api/core/v3/attachments/file/" + library_loader_content_id + "/data'></scr"+"ipt>\n"
								+ "<scr"+"ipt>\n"
								+ "$j.load_library('content_viewer_widget.css');\n"
								+ "$j.load_library('content_viewer_widget.js');\n"
								+ "var sourceURL='" + sourceURL + "';\n"
								+ "var showIcons=" + showTOCIcons + ";\n"
								+ "var showHovers=" + showTOCHovers + ";\n"
								+ "var tocLayout='" + toc_layout + "';\n"
								+ "var unselectedTextColor='" + unselectedTextColor +"';\n"
								+ "var unselectedBackgroundColor='" + unselectedBackgroundColor +"';\n"
								+ "var unselectedBorderColor='" + unselectedBorderColor +"';\n"
								+ "var hoverTextColor='" + hoverTextColor +"';\n"
								+ "var hoverBackgroundColor='" + hoverBackgroundColor +"';\n"
								+ "var hoverBorderColor='" + hoverBorderColor +"';\n"
								+ "var selectedTextColor='" + selectedTextColor +"';\n"
								+ "var selectedBackgroundColor='" + selectedBackgroundColor +"';\n"
								+ "var selectedBorderColor='" + selectedBorderColor +"';\n"
								+ "var borderWidth='" + borderWidth + "px';\n"
								+ "var fontSize='" + fontSize + "px';\n"
								+ "</scr"+"ipt>\n"
								+ "<div id='ContentViewerContainer'></div>\n" );
	$j('#generatedCodeDiv').show();
	resize();
}

function startOver(){
	hideAll();
	$j('#tocDiv').show();
	$j('#URLStatus').html('');
	$j('#docURLInput').val('');
	sourceURL = '';
	resize();
}

function resize(){
	setTimeout(resizeMe,100);
}

function init() {
	resize();
}

$j(document).ready(function() {
	var ua = window.navigator.userAgent;
	var msie = ua.indexOf('MSIE ');
	var IEVersion = parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)));
	if(IEVersion <= 8){
		$j('#docURLInput').attr('onpropertychange', 'toggleNextButton()');
	} else {
		$j('#docURLInput').bind('input', function() {
			toggleNextButton();
		});
	}
	
	$j("#unselectedTextColor").spectrum({
		color: unselectedTextColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			unselectedTextColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			unselectedTextColor = color.toHslString();
			customizeMenu();
		}
	});
	
	$j("#unselectedBackgroundColor").spectrum({
		color: unselectedBackgroundColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			unselectedBackgroundColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			unselectedBackgroundColor = color.toHslString();
			customizeMenu();
		}
	});
	
	$j("#unselectedBorderColor").spectrum({
		color: unselectedBorderColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			unselectedBorderColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			unselectedBorderColor = color.toHslString();
			customizeMenu();
		}
	});
		
	$j("#hoverTextColor").spectrum({
		color: hoverTextColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			hoverTextColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			hoverTextColor = color.toHslString();
			customizeMenu();
		}
	});
	
	$j("#hoverBackgroundColor").spectrum({
		color: hoverBackgroundColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			hoverBackgroundColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			hoverBackgroundColor = color.toHslString();
			customizeMenu();
		}
	});
	
	$j("#hoverBorderColor").spectrum({
		color: hoverBorderColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			hoverBorderColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			hoverBorderColor = color.toHslString();
			customizeMenu();
		}
	});
		
	$j("#selectedTextColor").spectrum({
		color: selectedTextColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			selectedTextColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			selectedTextColor = color.toHslString();
			customizeMenu();
		}
	});
	
	$j("#selectedBackgroundColor").spectrum({
		color: selectedBackgroundColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			selectedBackgroundColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			selectedBackgroundColor = color.toHslString();
			customizeMenu();
		}
	});
	
	$j("#selectedBorderColor").spectrum({
		color: selectedBorderColor,
	 	showAlpha: true,
	 	showInput: true,
	 	move: function(color) {
			selectedBorderColor = color.toHslString();
			customizeMenu();
		},
	 	hide: function(color) {
			selectedBorderColor = color.toHslString();
			customizeMenu();
		}
	});
	
	$j('#fontSize_slider').on("input change", function() {
		document.getElementById("fontSize").value = $j(this).val();
	});

	$j('#fontSize_slider').change(function () {
		document.getElementById("fontSize").value = $j(this).val();
		fontSize = $j(this).val();
		customizeMenu();
	});

	$j('#borderWidth_slider').on("input change", function() {
		document.getElementById("borderWidth").value = $j(this).val();
	});

	$j('#borderWidth_slider').change(function () {
		document.getElementById("borderWidth").value = $j(this).val();
		borderWidth = $j(this).val();
		customizeMenu();
	});

	$j("#tocCode").click(function() {
		$j("#tocCodeBox").select();
		return false;
	});
	$j("#viewerCode").click(function() {
		$j("#viewerCodeBox").select();
		return false;
	});
});
</script>




<style>
.color-select {
	float: left;
	border: 1px solid #ccc;
	border-radius: 5px;
}

#unselected-item {
	padding: 5px;
	border: 1px solid #ccc;
	border-radius: 3px;
	text-decoration: none;
	font-weight: bold;
	color: #069;
}

#hover-item {
	padding: 5px;
	border: 1px solid #ccc;
	border-radius: 3px;
	text-decoration: none;
	font-weight: bold;
	color: #069;
}

#selected-item {
	padding: 5px;
	border: 1px solid #ccc;
	border-radius: 3px;
	text-decoration: none;
	font-weight: bold;
	color: #069;
}

#fontSize {
	width: 5%;
}
#fontSize_slider {
	width: 75%;
	display: inline;
}
#borderWidth {
	width: 5%;
}
#borderWidth_slider {
	width: 75%;
	display: inline;
}
</style>




<div id='ContentViewerBuilderContainer'>

	<div id='builderTitle' class='page-header'> 
		<h2>Content Viewer Widget Builder</h2> 
	</div>
	<div id='tocDiv'>
		<p style='color:#2AABD2;'>Please paste the URL of your Table of Content Document</p>
		<form id="tocForm" name="tocForm" onsubmit="return false;">
			<input id="docURLInput" type="text"  placeholder="ToC Document URL"/>
		</form>
		<div id='URLStatus' style='color:red;'></div>
		<br/>
		<div id='toc_layout'>
			ToC Layout:&nbsp;
			<label class="radio-inline">
				<input type="radio" name="toc_layout" id="radios-0" value="vertical" checked="checked">
				Vertical
			</label>
			<label class="radio-inline" for="-">
				<input type="radio" name="toc_layout" id="radios-1" value="horizontal">
				Horizontal
			</label>
		</div>
		<br/>
		<input type="checkbox" name="tocIcons" id="tocIcons" value=true> Show ToC Icons</input>
		<br/>
		<br/>
		<input type="checkbox" name="tocHover" id="tocHover" value=true> Show ToC People and Place Hover Popups</input>
		<br/>
		<br/>
		<button id='nextButton' class='btn btn-info btn-small' onclick='customize()' disabled>Next</button>
	</div>

	<div id='customizationPage' style="display: none;" class="col-xs-12">
		<div class="col-xs-4 color-select">
			<br/>
			<span id='unselected-item'>Unselected Item</span>
			<br/>
			<br/>
			<b>Text: </b><input id='unselectedTextColor' class="color form-control form-control-inline" value="069">
			<br/>
			<br/>
			<b>Background: </b><input id='unselectedBackgroundColor' class="color form-control form-control-inline" value="f0f0f0">
			<br/>
			<br/>
			<b>Border: </b><input id='unselectedBorderColor' class="color form-control form-control-inline" value="BDBDBD">
			<br/>
			<br/>
		</div>
		<div class="col-xs-4 color-select">
			<br/>
			<span id='hover-item'>Hover Over Item</span>
			<br/>
			<br/>
			<b>Text: </b><input id='hoverTextColor' class="color form-control form-control-inline" value="069">
			<br/>
			<br/>
			<b>Background: </b><input id='hoverBackgroundColor' class="color form-control form-control-inline" value="f0f0f0">
			<br/>
			<br/>
			<b>Border: </b><input id='hoverBorderColor' class="color form-control form-control-inline" value="BDBDBD">
			<br/>
			<br/>
		</div>
		<div class="col-xs-4 color-select">
			<br/>
			<span id='selected-item'>Selected Item</span>
			<br/>
			<br/>
			<b>Text: </b><input id='selectedTextColor' class="color form-control form-control-inline" value="069">
			<br/>
			<br/>
			<b>Background: </b><input id='selectedBackgroundColor' class="color form-control form-control-inline" value="ffffff">
			<br/>
			<br/>
			<b>Border: </b><input id='selectedBorderColor' class="color form-control form-control-inline" value="BDBDBD">
			<br/>
			<br/>
		</div>
		<div class="col-xs-12 color-select">
			<br/>
			<b>Font Size:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>
			<input type="text" id="fontSize" value="12" readonly/>&nbsp;&nbsp;
			8<input type="range" min="8" max="32" id="fontSize_slider" value="12"/>&nbsp;32
			<br/>
			<br/>
			<b>Border Width: </b>
			<input type="text" id="borderWidth" value="1" readonly/>&nbsp;&nbsp;
			0<input type="range" min="0" max="10" id="borderWidth_slider" value="1"/>&nbsp;10
			<br/>
			<br/>
		</div>
		<div class="col-xs-12">
			<br/>
			<button class='btn btn-info btn-small' id='pageTwoBackButton' onclick='startOver()'>Back</button>
			<button class='btn btn-info btn-small' id='pageTwoNextButton' onclick='finish()'>Next</button>
			<br/>
			<br/>
		</div>
	</div>


	<div id = 'generatedCodeDiv'>
		<p>The Content Viewer uses two widgets to operate.  The first widget becomes the <b>Table of Content</b> where users can click the ToC items, and the linked-to content is then loaded into the viewer panel.  The second widget code drives the <b>Viewer Panel</b>.</p>
		<div id='tocCode'>
			<h3>1 - Table of Content</h3>
			Paste the below code into an HTML widget that is in a narrow column for vertical ToCs, or a wide column for horizontal ToCs:
			<textarea id='tocCodeBox' readonly></textarea>
		</div>
		<br/>
		<div id='viewerCode'>
			<h3>2 - Viewer Panel</h3>
			Put the below code into another HTML widget that is in a wide enough column that it can display the content without chopping it off:
			<textarea id='viewerCodeBox' readonly></textarea>
		</div>
		<br/>
		<button class='btn btn-info btn-small' id='pageTwoBackButton' onclick='customize()'>Back</button>
		<button class='btn btn-info btn-small' onclick='startOver()'>Start Over</button>
	</div> 

</div>

